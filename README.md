# JavaEPAMSpring2016

<pre>

<div class="panelMacro"><table class="warningMacro"><colgroup><col width="24"><col></colgroup><tbody><tr><td valign="top"><img src="/conf2/images/icons/emoticons/forbidden.png" alt="" align="absmiddle" border="0" height="16" width="16"></td><td><p><span style="color: rgb(0,0,255);"><strong>input.xsd</strong></span> должен декларировать целевое пространство имен (атрибут <strong><em>targetNamespace</em> </strong>должен присутствовать)<br><span style="color: rgb(255,102,0);"><strong>input.xml</strong></span> должен быть валидным относительно <span style="color: rgb(0,0,255);"><strong>input.xsd</strong></span></p><p>Выходные XML документы <span style="color: rgb(255,0,0);"><strong>output.dom.xml</strong></span>, <strong><span style="color: rgb(255,0,0);">output.sax.xml</span></strong> и <span style="color: rgb(255,0,0);"><strong>output.stax.xml</strong></span> должны быть валидны относительно исходной XML схемы <span style="color: rgb(0,0,255);"><strong>input.xsd</strong></span> <u><em><strong>если из нее исключить</strong></em></u> декларирование целевого пространства имен (см. файл&nbsp;<strong>input-no-targetNamespace.xsd</strong> в ST3Example)</p><p>(Замечание: выходные XML документы не обязаны объявлять атрибут <em><strong>noNamespaceSchemaLocation</strong></em>)</p></td></tr></tbody></table></div><h3 id="SummaryTask3-Задание">Задание</h3><p>Задача сформулирована следующим образом.</p><ol><li>Создать файл XML (<strong>input.xml</strong>) и соответствующую ему схему XSD (<strong>input.xsd</strong>).</li><li>При разработке XSD обязательно использовать: простые и комплексные типы, перечисления, шаблоны и предельные значения.</li><li>Создать Java-класс, соответствующий данному описанию.</li><li>Создать Java-приложение (назвать <strong>Main</strong>) для разбора XML-документа и инициализации контейнера объектов информацией из XML-файла. Для разбора использовать: SAX, StAX парсеры, а также DOM анализатор (все три варианта).</li><li>Определить методы, которые будут сортировать объекты контейнера с использованием интерфейса Comparator по некоторому параметру или набору параметров (три парсера =&amp;gt; три варианта сортировки =&amp;gt; три метода).</li><li>Произвести проверку XML-документа на валидность относительно XSD (с помощью валидирующего парсера или validation API).</li><li>Определить метод сохранения информации из контейнера в XML-документ.</li><li>Продемонстрировать работу приложения:<br><ul><li>&nbsp;каждым из парсеров прочитать XML-документ;</li><li>получить контейнер объектов;</li><li>отсортировать объекты в контейнере (одним из трех способов);</li><li>сохранить отсортированный контейнер в XML-документ (в файл).</li></ul></li><li>Входными данными приложения являются имена двух файлов: XML-документа и XSD-документа; выходными данными - три XML файла. Имена входных файлов задавать параметрами командной строки (два параметра или один, если валидирование будет происходить относительно схемы, заданной внутри XML-документа).</li><li><p>Для демонстрации работы приложения создать класс Demo, который вызывает метод Main.main вашего приложения с соответствующим значением параметров командной строки (хардкод параметров командной строки):</p><div class="code panel" style="border-width: 1px;"><div class="codeHeader panelHeader" style="border-bottom-width: 1px;"><b>Demo.java</b></div><div class="codeContent panelContent">
<div><div id="highlighter_375669" class="syntaxhighlighter nogutter  java"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container" title="Hint: double-click to select code"><div class="line number1 index0 alt2"><code class="java keyword">package</code> <code class="java plain">ua.nure.your_last_name.SummaryTask3;</code></div><div class="line number2 index1 alt1"><code class="java preprocessor">/**</code></div><div class="line number3 index2 alt2"><code class="java spaces">&nbsp;</code><code class="java preprocessor">* Demo class to run project WO command line.</code></div><div class="line number4 index3 alt1"><code class="java spaces">&nbsp;</code><code class="java preprocessor">*/</code></div><div class="line number5 index4 alt2"><code class="java keyword">class</code> <code class="java plain">Demo {</code></div><div class="line number6 index5 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">public</code> <code class="java keyword">static</code> <code class="java keyword">void</code> <code class="java plain">main(String[] args) </code><code class="java keyword">throws</code> <code class="java plain">Exception {</code></div><div class="line number7 index6 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">Main.main(</code><code class="java keyword">new</code> <code class="java plain">String[] { </code><code class="java string">"input.xml"</code> <code class="java plain">});</code></div><div class="line number8 index7 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number9 index8 alt2"><code class="java plain">}</code></div></div></td></tr></tbody></table></div></div>
</div></div></li><li><s><span style="color: rgb(255,0,0);">Написать тесты, покрытие кода тестами должно быть 100%, тесты должны находится в своем src каталоге с именем <strong>test</strong>.</span></s></li><li>Классы верхнего уровня и нетривиальные методы должны быть документированы.</li><li>Опционально. Создать XSL документ преобразующий XML-документ в документ HTML.</li></ol><div class="panel" style="border-width: 1px;"><div class="panelHeader" style="border-bottom-width: 1px;"><b>Соглашение об именованиях</b></div><div class="panelContent">
<p>Корневой элемент XML документа назвать согласно названию задачи или исходя из того что это контейнер однотипных элементов, имя которого указано в задаче.<br>Пример: если задача называется <strong><span style="color: rgb(51,153,102);">Тестирование</span></strong>, а элемент имеет имя <span style="color: rgb(0,0,255);"><strong>Test</strong></span>, то корневой элемент можно назвать либо <strong><span style="color: rgb(51,153,102);">Testing</span> </strong>либо <span style="color: rgb(0,0,255);"><strong>Tests</strong></span>.<br><br>Входные и выходные файлы должны иметь следующие имена.<br>Входные файлы:</p><ul><li><strong>input.xml</strong> - XML-документ, валидный относительно input.xsd</li><li><strong>input.xsd</strong> - XSD-докумен, схема для input.xml</li></ul><p>Выходные файлы (результат):</p><ul><li><strong>output.dom.xml</strong> - результат работы DOM-анализатора и последующей сортировки одним из трех способов.</li><li><strong>output.sax.xml</strong> - результат работы SAX-парсера и последующей сортировки одним из трех способов.</li><li><strong>output.stax.xml</strong> - результат работы StAX-парсера после сортировки одним из трех способов.&nbsp;</li></ul>
</div></div><p>Пример решения аналогичной задачи находится в репозитории по адресу:<br>/examples/projects/ST3Example<br><br></p><div class="panelMacro"><table class="infoMacro"><colgroup><col width="24"><col></colgroup><tbody><tr><td valign="top"><img src="/conf2/images/icons/emoticons/information.png" alt="" align="absmiddle" border="0" height="16" width="16"></td><td><p>Далее идет словесное описание бизнес области (у каждого своя область).</p></td></tr></tbody></table></div><p>&nbsp;</p><hr><h3 id="SummaryTask3-Пример">Пример</h3><p>В репозитории находится пример решения аналогичной задачи.</p><p>Тест.<br>Вопросы теста имеют следующие характеристики:<br><strong>Question</strong> - содержание вопроса;<br><strong>Answers</strong> - ответы (один или несколько правильных)<br>Корневой элемент <strong>Test</strong>.</p><p>В репозитории содержится два варианта решения задачи.</p><div class="table-wrap"><table class="confluenceTable tablesorter"><thead><tr class="sortableHeader"><th data-column="0" class="confluenceTh sortableHeader"><div class="tablesorter-header-inner">№</div></th><th data-column="1" class="confluenceTh sortableHeader"><div class="tablesorter-header-inner">Описание</div></th><th data-column="2" colspan="1" class="confluenceTh sortableHeader"><div class="tablesorter-header-inner">Адрес</div></th><th data-column="3" colspan="1" class="confluenceTh sortableHeader"><div class="tablesorter-header-inner">Примечание</div></th></tr></thead><tbody><tr><td colspan="1" class="confluenceTd">1</td><td colspan="1" class="confluenceTd">Содержит решение задачи с применением технологий<br> DOM, SAX, StAX (высокоуровневый)</td><td colspan="1" class="confluenceTd">/examples/projects/ST3Example</td><td colspan="1" class="confluenceTd">Достаточно ограничить решение своей задачи указанными технологиями.</td></tr><tr><td colspan="1" class="confluenceTd"><span style="color: rgb(153,153,153);">2</span></td><td colspan="1" class="confluenceTd"><p><span style="color: rgb(153,153,153);">Вариант №1 плюс дополнительно низкоуровневый StAX,</span><br><span style="color: rgb(153,153,153);"> а также JDOM, JAXB, Validation API, XSLT</span></p></td><td colspan="1" class="confluenceTd"><span style="color: rgb(153,153,153);">/examples/projects/ST3ExampleExtra</span></td><td colspan="1" class="confluenceTd"><p><span style="color: rgb(153,153,153);">Рекомендуется (это не обязательно!) использовать указанные технологии при решении своей задачи</span><br><span style="color: rgb(153,153,153);"><em>(<span style="color: rgb(0,0,0);">данный пример в репозитории отсутствует</span>)</em></span></p></td></tr></tbody></table></div><div class="panelMacro"><table class="infoMacro"><colgroup><col width="24"><col></colgroup><tbody><tr><td valign="top"><img src="/conf2/images/icons/emoticons/information.png" alt="" align="absmiddle" border="0" height="16" width="16"></td><td><p>Вариант №2 рекомендуется брать за основу при решении своей задачи, если вы хотите более углубленно изучить Java+XML.</p></td></tr></tbody></table></div><div class="panelMacro"><table class="warningMacro"><colgroup><col width="24"><col></colgroup><tbody><tr><td valign="top"><img src="/conf2/images/icons/emoticons/forbidden.png" alt="" align="absmiddle" border="0" height="16" width="16"></td><td><p>Брать за основу не означает взять код и править его под свою задачу. Создавайте проект с нуля. Пример служит исключительно для ознакомления и понимания схемы работы тех или иных технологий. Смотрите в код примера и делайте <u>свою </u>задачу.</p></td></tr></tbody></table></div><h4 id="SummaryTask3-ST3Example">ST3Example</h4><p>В примере показана работа с технологиями <strong>DOM</strong>, <strong>SAX</strong>, <strong>StAX</strong> (высокоуровневый, основанный на XMLEventReader) . Подключение внешних библиотек не требуется. Но если положить в classpath внешнюю реализацию DOM/SAX/StAX то будет работать именно она.</p><p>Для каждой технологии написан свой контроллер. В каждом из них есть метод main, который тестирует соответствующий контроллер. Для запуска приложения достаточно в Eclipse запустить метод main класса Demo. Метод main класса Main демонстрирует работу всех трех контроллеров, при этом входные данные:</p><ul><li>input.xsd - XML схема с целевым пространством имен;</li><li>input.xml - XML документ, валидный, относительно схемы (корневой элемент квалифицирован, т.е. с префиксом).</li></ul><p>Каждый контроллер разбирает соответствующей технологией входной XML документ и создает контейнер <strong>Test</strong>, содержащий объекты Question. Далее метод main при помощи класса утилиты Sorter сортирует контейнер на основе каких то критериев (всего три способа сортировки - для каждого контроллера свой) и сохраняет результат в выходном XML документе. Сохранение осуществляется с помощью трансформации контейнера Test в DOM, а затем DOM сохраняется в XML (один из возможных способов).</p><div class="panelMacro"><table class="noteMacro"><colgroup><col width="24"><col></colgroup><tbody><tr><td valign="top"><img src="/conf2/images/icons/emoticons/warning.png" alt="" align="absmiddle" border="0" height="16" width="16"></td><td><p>Выходные XML документы <u>не будут</u> являться валидными относительно input.xsd, т.к. корневой элемент в них не квалифицирован (сделано для упрощения кода). Как квалифицировать корневой элемент - см. код проекта ST3Example.</p></td></tr></tbody></table></div><p>Если собрать приложение в jar файл, то запустить можно так:</p><div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<div><div id="highlighter_36185" class="syntaxhighlighter nogutter  java"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container" title="Hint: double-click to select code"><div class="line number1 index0 alt2"><code class="java plain">java -jar ST3Example.jar input.xml</code></div></div></td></tr></tbody></table></div></div>
</div></div><p>При этом в каталоге, откуда вы запускаете приложение, должен находится файл схема input.xsd, т.к. DOMController и SAXController валидируют документ XML относительно данной схемы.</p><h4 id="SummaryTask3-ST3ExampleExtra">ST3ExampleExtra</h4><p>Дополнительно к предыдущему варианту добавлен контроллеры для <strong>JDOM</strong>, <strong>JAXB</strong>; <strong>STAX</strong> контроллер дополнен низкоуровневым разбором с помощью логического курсора (см. метод STAXController#parse2). Также показана работа с <strong>Validation</strong> API и работа с <strong>XSL</strong> преобразованиями.</p><p>Проект в Eclipse содержит в classpath ссылку на четыре пользовательские библиотеки: JDOM, Xerces, Woodstox и JAXB-RI. Но для запуска требуется только JDOM - нужно создать пользовательскую библиотеку с именем JDOM и подключить ее к проекту, в противном случае код не откомпилируется. Подключение остальных библиотек не обязательно. Для запуска приложения достаточно в Eclipse запустить метод main класса Demo. Метод main класса Main демонстрирует работу пяти контроллеров, при этом входные данные:</p><ul><li>input.xsd - XML схема с целевым пространством имен;</li><li>input.xml - XML документ, валидный, относительно схемы (корневой элемент квалифицирован, т.е. с префиксом);</li><li>input.xsl - XSL документ преобразования input.xml в HTML файл.</li></ul><p>Если собрать приложение в jar файл, то запустить можно так:</p><div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<div><div id="highlighter_623649" class="syntaxhighlighter nogutter  java"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container" title="Hint: double-click to select code"><div class="line number1 index0 alt2"><code class="java plain">java -jar ST3ExampleExtra.jar input.xml input.xsd input.xsl</code></div></div></td></tr></tbody></table></div></div>
</div></div><p>При этом в jar файле в META-INF/MANIFEST.MF должна быть указана зависимость jdom:</p><div class="code panel" style="border-width: 1px;"><div class="codeHeader panelHeader" style="border-bottom-width: 1px;"><b>META-INF/MANIFEST.MF</b></div><div class="codeContent panelContent">
<div><div id="highlighter_400797" class="syntaxhighlighter nogutter  java"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container" title="Hint: double-click to select code"><div class="line number1 index0 alt2"><code class="java plain">...</code></div><div class="line number2 index1 alt1"><code class="java plain">Class-Path: jdom-</code><code class="java value">2.0</code><code class="java plain">.</code><code class="java value">3</code><code class="java plain">.jar</code></div></div></td></tr></tbody></table></div></div>
</div></div><p>Дополнительно можно подключить следующие библиотеки:</p><ul><li><strong>Xerces</strong> - работа DOMController и SAXController будет основана на внешней реализации DOM/SAX из Xerces.</li><li><strong>Woodstox</strong> - работа STAXController будет основана на внешней реализации StAX из Woodstox</li><li><strong>JAXB-RI</strong> - JAXBController сможет контролировать имя префикса корневого элемента, если вы запускаете приложение с помощью JVM 6 (для седьмой версии подключение данной библиотеки не обязательно).</li></ul><p>Выходные XML документы будут валидными относительно input.xsd.</p><p>В методе Main#main продемонстрировано сохранение XML тремя способами:</p><ol><li>через DOM как и в ST3Example;</li><li>с помощью JAXB;</li><li>с помощью JDOM.</li></ol><hr><h3 id="SummaryTask3-Замечание">Замечание</h3><p>Возможно, окажется полезной информация по наследованию типов в XSD: <span><a href="http://192.168.65.100:8000/conf2/display/JTG/Type+inheritance" class="external-link" rel="nofollow">Type inheritance</a></span></p>
    
        </div>


</pre>
